# ステップ1：環境構築（10分）

このドキュメントでは、Marpを使ってMarkdownからPowerPointを生成するための環境を準備します。

---

## 🎯 このステップで達成すること

- ✅ Marp for VS Code（拡張機能）のインストール
- ✅ Node.js のインストール（Marp CLI用）
- ✅ Marp CLI のインストール
- ✅ 動作確認

---

## 📦 方法A：VS Code拡張機能のみ（非技術者向け・5分）

### 手順1：Marp for VS Codeをインストール

1. **VS Codeを起動**します

2. **左側のメニューから「拡張機能」アイコンをクリック**
   - アイコンは四角いブロックが4つ並んだ形です
   - ショートカット：`Ctrl + Shift + X`

3. **検索ボックスに「Marp」と入力**

4. **「Marp for VS Code」を見つけてインストール**
   - 作者：`Marp team`
   - 緑色の「インストール」ボタンをクリック

5. **インストール完了後、VS Codeを再起動**
   - メニュー → ファイル → 終了
   - もう一度VS Codeを起動

### 手順2：動作確認

1. **新しいファイルを作成**
   - メニュー → ファイル → 新しいファイル

2. **以下の内容をコピー＆ペースト**

```markdown
---
marp: true
---

# テストスライド

これはテストです。

---

## スライド2

Marpが正しく動作しています！
```

3. **ファイルを保存**
   - メニュー → ファイル → 名前を付けて保存
   - ファイル名：`test.md`
   - 保存場所：デスクトップなど、分かりやすい場所

4. **プレビューを確認**
   - VS Code画面右上の「Marpプレビューを開く」アイコンをクリック
   - または `Ctrl + Shift + V` を押す
   - **スライド形式でプレビューが表示されればOK！**

### 手順3：PDFにエクスポート

1. **プレビュー画面右上の「…」メニューをクリック**

2. **「Export slide deck」を選択**

3. **「PDF」を選択**

4. **保存先を指定して保存**
   - デスクトップに `test.pdf` として保存してみましょう

5. **PDFファイルを開いて確認**
   - スライドが表示されていれば成功です！

---

## 🔧 方法B：Marp CLI（技術者向け・10分）

PowerPoint（.pptx）ファイルを直接生成したい場合は、Marp CLIが必要です。

### 前提条件
- Node.js がインストールされていること
- コマンドプロンプトまたはPowerShellが使えること

---

### 手順1：Node.jsのインストール確認

1. **コマンドプロンプトを開く**
   - `Win + R` → `cmd` と入力 → Enter

2. **Node.jsのバージョンを確認**

```bash
node -v
```

3. **結果の確認**
   - バージョン番号（例：`v18.17.0`）が表示されればOK → 手順2へ
   - 「コマンドが見つかりません」と表示された場合 → Node.jsをインストール

---

### 補足：Node.jsのインストール（必要な場合のみ）

1. **公式サイトにアクセス**
   - https://nodejs.org/ja/

2. **「LTS」版をダウンロード**
   - 緑色の「推奨版」ボタンをクリック

3. **ダウンロードしたファイルを実行**
   - `node-v18.xx.x-x64.msi` などのファイル名

4. **インストーラーの指示に従う**
   - すべてデフォルト設定でOK
   - 「Next」を押していくだけ

5. **インストール完了後、コマンドプロンプトを再起動**

6. **再度確認**
```bash
node -v
npm -v
```
   - 両方ともバージョンが表示されればOK

---

### 手順2：Marp CLIのインストール

1. **コマンドプロンプトで以下を実行**

```bash
npm install -g @marp-team/marp-cli
```

2. **インストール完了まで待つ**
   - 数分かかる場合があります
   - インターネット接続が必要です

3. **インストール確認**

```bash
marp --version
```

   - バージョン番号（例：`@marp-team/marp-cli v3.4.0`）が表示されればOK

---

### 手順3：動作確認（PowerPoint生成）

1. **テスト用Markdownファイルを作成**
   - 前述の方法Aで作成した `test.md` を使用
   - または、デスクトップに新しく `test.md` を作成

2. **コマンドプロンプトで、ファイルがある場所に移動**

```bash
cd C:\Users\あなたのユーザー名\Desktop
```

3. **PowerPointファイルを生成**

```bash
marp --pptx test.md
```

4. **生成されたファイルを確認**
   - 同じフォルダに `test.pptx` が作成されているはずです
   - ファイルをダブルクリックして、PowerPointで開いてみましょう

5. **PowerPointで正しく表示されればOK！**

---

## ✅ 環境構築の完了チェックリスト

### 方法A（VS Code拡張機能）を選んだ場合
- [ ] Marp for VS Code 拡張機能がインストールされている
- [ ] Markdownファイルのプレビューがスライド形式で表示される
- [ ] PDFファイルにエクスポートできた

### 方法B（Marp CLI）を選んだ場合
- [ ] Node.jsがインストールされている（`node -v` でバージョン確認済み）
- [ ] Marp CLIがインストールされている（`marp --version` でバージョン確認済み）
- [ ] PowerPointファイル（.pptx）が生成できた

---

## ⚠️ よくあるトラブルと解決方法

### Marpプレビューが表示されない
**原因**：Markdownファイルの先頭に `---marp: true---` がない

**解決方法**：ファイルの最初に以下を追加
```markdown
---
marp: true
---
```

---

### PowerPoint生成時に「Chromiumのダウンロード」メッセージが出る
**原因**：Marp CLIが初回実行時にブラウザエンジンをダウンロードしている

**解決方法**：そのまま待つ（数分かかります）。次回からは表示されません。

---

### 「コマンドが見つかりません」エラー
**原因1**：Node.jsまたはMarp CLIがインストールされていない
**解決方法**：上記の手順に従って、再度インストールしてください

**原因2**：コマンドプロンプトを再起動していない
**解決方法**：コマンドプロンプトを一度閉じて、再度開いてください

---

## 🎯 次のステップ

環境構築が完了しました！次は実際にサンプルを使って、プレゼンテーション資料を作成してみましょう。

➡️ **次へ：`docs/02_基本的な使い方.md`**

---

## 💡 豆知識

### Marp for VS Code と Marp CLI、どちらを使えばいい？

| 項目 | Marp for VS Code | Marp CLI |
|------|------------------|----------|
| 対象者 | 非技術者向け | 技術者向け |
| 操作方法 | GUIで簡単 | コマンドライン |
| 出力形式 | PDF | PDF / PPTX / HTML |
| カスタマイズ | 基本的なテーマ | 高度なカスタマイズ |
| おすすめ | 初めての方 | 自動化したい方 |

**結論**：最初は VS Code拡張機能で慣れて、必要に応じてCLIに移行するのがおすすめです。